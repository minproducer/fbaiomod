const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./fontkit.es-ByWJr3uE.js","./index-CjN63LTw.js","./index-BoH2j3cU.js","./index-DY-hiTTZ.css","./index-DLw-zyro.js","./MyApp-D93h0aQZ.js"])))=>i.map(i=>d[i]);
import{aQ as t,aP as e,cR as a}from"./index-BoH2j3cU.js";async function o({imgUrls:a,contentUrls:o,fileName:c,injectText:d=!0,onProgress:l}){const h=a.length;let w=null;const m=(await t((async()=>{const{default:t}=await import("./fontkit.es-ByWJr3uE.js");return{default:t}}),__vite__mapDeps([0,1,2,3]),import.meta.url)).default,g=await t((()=>import("./index-DLw-zyro.js")),__vite__mapDeps([4,1,2,3]),import.meta.url),{PDFDocument:f,PDFName:p,PDFString:u,rgb:_}=g,y=await f.create();y.registerFontkit(m);const A=(await t((async()=>{const{default:t}=await import("./NotoSans-Regular-COT0XZjX.js");return{default:t}}),[],import.meta.url)).default,P=await fetch(A).then((t=>t.arrayBuffer())),b=await y.embedFont(P),{parseSafe:R}=await t((async()=>{const{parseSafe:t}=await import("./MyApp-D93h0aQZ.js").then((t=>t.aX));return{parseSafe:t}}),__vite__mapDeps([5,2,3]),import.meta.url);for(let t=0;t<h;t++)try{l(t,h);const c=a[t],m=await i(c);console.log(m),w||(w=await r(m));const g=m.startsWith("data:image/webp;base64,"),f=m.startsWith("data:image/jpeg;base64,"),A=g?await s(m):m,P=f?await y.embedJpg(A):await y.embedPng(A),x=y.addPage([w.width,w.height]);if(x.drawImage(P,{x:0,y:0,width:w.width,height:w.height}),o[t]){const a=await e(o[t]),i=R(a.split("\n").at(-1)),[r,s,c,l,h,m]=i;console.log(l);const g=w.width/s;if(d&&(null==l?void 0:l.length)){const t=n(l);for(const e of t)try{const t=e[0],a=e[1],[o,n,i,r]=t.map((t=>t*g));let s=i/b.heightAtSize(i);s*=r/b.widthOfTextAtSize(a,s),x.drawText(a+" ",{x:n,y:w.height-o-s,size:s,font:b,color:_(1,1,1),opacity:0})}catch(E){console.error(E)}}if(d&&(null==m?void 0:m.length)){console.log(m);const t=w.height,e=[];for(const a of m){const[o,n,i,r]=a[1].map((t=>Math.round(t*g))),s=[n,t-o-i,n+r,t-o],c=x.doc.context.register(x.doc.context.obj({Type:"Annot",Subtype:"Link",Rect:s,Border:[0,0,0],A:{Type:"Action",S:"URI",URI:u.of(a[3])}}));e.push(c),console.log(g,s,a[3])}x.node.set(p.of("Annots"),y.context.obj(e))}}}catch(E){console.error("downloadPDFFromImageUrls",t,E)}const x=await y.save(),I=new Blob([x],{type:"application/pdf"}),j=URL.createObjectURL(I),{download:D}=await t((async()=>{const{download:t}=await import("./download-KJKGHAGZ.js");return{download:t}}),[],import.meta.url);D(j,c)}function n(t){const e=[];for(const a of t)"string"==typeof a[1]?e.push(a):Array.isArray(a[1])&&e.push(...n(a[1]));return e}async function i(t){return(await a(t)).body}async function r(t){const e=new Image;return e.src=t,await e.decode(),{width:e.width,height:e.height}}function s(t){return new Promise((e=>{const a=new Image;a.onload=()=>{const t=document.createElement("canvas");t.width=a.width,t.height=a.height;t.getContext("2d").drawImage(a,0,0);const o=t.toDataURL("image/png");e(o),a.remove(),t.remove()},a.src=t}))}export{o as downloadPDFFromImageUrls};
