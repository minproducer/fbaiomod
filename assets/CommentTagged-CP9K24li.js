import{r as e,b3 as i,b8 as n}from"./index-BoH2j3cU.js";import{u as l,d as o,t,S as a,I as r,i as d,h as s,l as m,e as u,f as v,T as c,o as g,b as p}from"./MyApp-D93h0aQZ.js";import{g as j}from"./tagged-BsamJxCG.js";import f from"./useCacheState-CRWoF5gI.js";import h from"./MyTable-B-PXqHUM.js";import{E as x}from"./ExportButton-bON9fXxS.js";import{checkVIP as y}from"./useVIP-f__zpoad.js";import"./index-CLQrWQaN.js";import"./index-DFDl0PJq.js";import"./DownOutlined-DRGhK8zp.js";import"./Table-CSd7eQib.js";import"./List-BGWr2xJE.js";import"./index-BaNQURuW.js";import"./index-BS-7HFpi.js";import"./index-p3GZU5lJ.js";import"./index-DWB43XHw.js";import"./Dropdown-C4ZC00F-.js";import"./PurePanel-DNUOZ5MP.js";import"./move-DCq-oE7y.js";import"./index-CTitp5Qg.js";import"./index-UsPtaxTh.js";import"./SearchOutlined-BUONfEHJ.js";import"./useBreakpoint-CUrvcDr2.js";import"./Pagination-CIrtJa5e.js";import"./index-7X6rB-D6.js";import"./row-B1CxNhq6.js";import"./sweetalert2.esm.all-BZxvatOx.js";import"./getIds-CXkkWBEB.js";import"./index-IueWr_3q.js";function b({target:b}){const{ti:k}=l(),{message:w}=o(),[T,C]=f("Tagged."+(null==b?void 0:b.id),[]),[N,_]=f("Tagged.loading."+(null==b?void 0:b.id),!1),[I,S]=f("Tagged.loadMore."+(null==b?void 0:b.id),!1),[D,A]=e.useState(!0);e.useEffect((()=>{L()}),[null==b?void 0:b.id]);const E=e.useRef(null==b?void 0:b.id),L=(e=!1)=>{if(!(null==b?void 0:b.id)||N)return;const i=E.current!==(null==b?void 0:b.id);(e||!T.length||i)&&(E.current=null==b?void 0:b.id,t("Tagged:onClickReload"),_(!0),j(b.id).then((e=>{(null==e?void 0:e.length)?(console.log(e),C(e),A(!0)):(w.info(k({en:"No data: Comments Tagged",vi:"Không có dữ liệu: Lượt tag bình luận"})),A(!1))})).finally((()=>{_(!1)})))},B=i.jsx(n,{icon:i.jsx("i",{className:"fa-solid fa-play"}),loading:I,disabled:!D||N,onClick:async()=>{var e;(null==b?void 0:b.id)&&!I&&await y()&&(t("Tagged:onClickLoadMore"),S(!0),j(b.id,null==(e=T[T.length-1])?void 0:e.cursor).then((e=>{const i=new Set(T.map((e=>e.id))),n=e.filter((e=>!i.has(e.id)));n.length?(C((e=>[...e,...n])),A(!0)):(w.info(k({en:"No more data",vi:"Không còn dữ liệu"})),A(!1))})).finally((()=>S(!1))))},children:k(D?{en:"Load more",vi:"Tải thêm"}:{en:"No more data",vi:"Không còn dữ liệu"})}),M=[{title:"#",key:"index",dataIndex:"index"},{title:k({en:"Owner",vi:"Người tag"}),key:"from",dataIndex:"from",render:(e,n,l)=>{var o,t,m,u,v;return(null==(o=null==n?void 0:n.from)?void 0:o.id)?i.jsxs(a,{children:[i.jsx(r,{src:d(null==(t=null==n?void 0:n.from)?void 0:t.id),style:{width:45,height:45,borderRadius:5}}),i.jsxs(a,{direction:"vertical",size:0,children:[i.jsx("a",{href:s(null==(m=null==n?void 0:n.from)?void 0:m.id),target:"_blank",rel:"noreferrer",children:i.jsx("b",{children:null==(u=null==n?void 0:n.from)?void 0:u.name})}),i.jsx("span",{style:{opacity:.5},children:null==(v=null==n?void 0:n.from)?void 0:v.id})]})]}):k({en:"Anonymous",vi:"Ẩn danh"})},filters:Array.from(new Set(null==T?void 0:T.map((e=>{var i;return null==(i=e.from)?void 0:i.id})))).map((e=>{var i,n;const l=T.filter((i=>{var n;return(null==(n=i.from)?void 0:n.id)===e}));return{value:e||"",text:((null==(n=null==(i=null==l?void 0:l[0])?void 0:i.from)?void 0:n.name)||k({en:"Anonymous",vi:"Ẩn danh"}))+` (${null==l?void 0:l.length})`,count:null==l?void 0:l.length}})).sort(((e,i)=>i.count-e.count)),onFilter:(e,i)=>{var n;return(null==(n=i.from)?void 0:n.id)==e},width:300},{title:k({en:"Content",vi:"Nội dung"}),key:"message",dataIndex:"message",render:(e,n,l)=>{var o;return i.jsx("div",{style:{wordBreak:"break-word",maxWidth:400},children:(null==(o=m(null==n?void 0:n.message,200))?void 0:o.replace(null==b?void 0:b.name,""))||(null==b?void 0:b.name)})}},{title:k({en:"Created at",vi:"Thời gian"}),key:"created_time",dataIndex:"created_time",render:(e,n,l)=>i.jsxs("span",{children:[u(new Date(e).getTime())," - ",v(new Date(e))]})},{title:k({en:"Action",vi:"Hành động"}),key:"action",dataIndex:"action",render:(e,l,o)=>i.jsx(c,{title:k({en:"View post",vi:"Xem bài viết"}),children:i.jsx(n,{target:"_blank",href:s(null==l?void 0:l.id),icon:i.jsx("i",{className:"fa-solid fa-external-link"})})}),width:100}];return i.jsx(h,{data:T.map(((e,i)=>({...e,index:i+1}))),columns:M,searchable:!0,keyExtractor:e=>e.id,size:"small",renderTitle:()=>i.jsxs(i.Fragment,{children:[i.jsxs(a.Compact,{children:[i.jsx(n,{type:"primary",icon:i.jsx("i",{className:"fa-solid fa-rotate-right"}),loading:N,disabled:I,onClick:()=>L(!0),children:k({en:"Reload",vi:"Tải lại"})}),B]}),i.jsx(x,{data:T,options:[{key:"json",label:".json",prepareData:e=>({fileName:(null==b?void 0:b.name)+"_tagged_comment.json",data:JSON.stringify(e,null,4)})},{key:"csv",label:".csv",prepareData:e=>({fileName:(null==b?void 0:b.name)+"_tagged_comment.csv",data:g(e.map((e=>{var i,n;return{...e,from:null==(i=e.from)?void 0:i.id,fromName:null==(n=e.from)?void 0:n.name}})))})}]}),i.jsx(p,{color:"red",children:(null==T?void 0:T.length)+" "+k({en:"Tagged Comment",vi:"Lượt tag bình luận"})})]}),footer:i.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center"},children:B})})}export{b as default};
