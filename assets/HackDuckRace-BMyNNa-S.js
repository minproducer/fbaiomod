import{r as e,b3 as n,b8 as t}from"./index-BoH2j3cU.js";import{waitWinForReady as r,runFnInWin as a}from"./window-Dhlqh9T1.js";import s from"./useCacheState-CRWoF5gI.js";import{u as i,d as l,t as o,c,S as u,ai as d,I as f,b as m}from"./MyApp-D93h0aQZ.js";import{S as h}from"./Screen-BEv7M6xj.js";import{D as p}from"./index-BwkmqrWl.js";import{R as g}from"./row-B1CxNhq6.js";import{I as w}from"./index-7X6rB-D6.js";import"./col-pZhDRk6E.js";import"./useBreakpoint-CUrvcDr2.js";import"./SearchOutlined-BUONfEHJ.js";const k=[{id:"Duck Race",url:"https://www.online-stopwatch.com/duck-race/",img:""+new URL("duck--6fNLnXb.png",import.meta.url).href},{id:"Emoji Race",url:"https://www.online-stopwatch.com/emoji-race-timer/",img:""+new URL("emoji-Dr6CgfhJ.png",import.meta.url).href},{id:"Wheel Name Picker",url:"https://www.online-stopwatch.com/random-name-pickers/name-picker-wheel/",img:""+new URL("wheel-lFKZS5xZ.png",import.meta.url).href}];function x(){const{ti:x}=i(),{message:R}=l(),[b,S]=e.useState(!1),[D,_]=e.useState(null),[C,I]=s("Duckrace.win",null),[E,N]=s("Duckrace.tags",[]),[H,A]=e.useState(!1),[q,L]=e.useState(""),[T,P]=e.useState(-1),[M,z]=e.useState(""),B=e.useRef(null),F=e.useRef(null);e.useEffect((()=>{if(C&&D){const e="Duckrace:processHack"+Date.now();R.loading({key:e,content:"Waiting for load...",duration:0}),r(C).then((()=>{R.loading({key:e,content:"Hacking...",duration:0}),a({win:C,fnPath:"window.eval",params:[v(E)]}).then((()=>{R.success({key:e,content:"Hacked duckrace: "+((null==E?void 0:E.length)?E:"random")})}))})).catch((n=>{R.error({key:e,content:"Hack failed: "+n.message})}))}}),[E,C,D]),e.useEffect((()=>{var e;H&&(null==(e=B.current)||e.focus())}),[H]),e.useEffect((()=>{var e;null==(e=F.current)||e.focus()}),[M]),e.useEffect((()=>{if(!C)return;const e=setInterval((()=>{C&&C.closed&&I(null)}),1e3);return()=>{clearInterval(e)}}),[C]),e.useEffect((()=>{o("HackDuckRace:onLoad")}),[]);const O=()=>{A(!0)},U=e=>{L(e.target.value)},W=()=>{if(q){const e=q.split(",").map((e=>e.trim())).filter((e=>e.length>0&&!E.includes(e)));e.length&&N([...E,...e])}A(!1),L("")},J=e=>{z(e.target.value)},K=()=>{const e=[...E];e[T]=M,N(e),P(-1),z("")};return n.jsxs(h,{mode:"center",title:x({en:"Hack DuckRace",vi:"Hack DuckRace"}),children:[n.jsxs(c.Text,{children:[x({en:"Cheat the random of Duckrace result",vi:"Kết quả Duckrace nằm trong tay bạn"})," ",n.jsx(c.Link,{href:"https://www.facebook.com/groups/fbaio/posts/1582618815726134",target:"_blank",children:n.jsx("i",{className:"fa-solid fa-arrow-up-right-from-square"})})]}),C?n.jsxs(u,{direction:"vertical",align:"center",children:[n.jsxs(n.Fragment,{children:[n.jsxs(c.Text,{children:[x({en:"Enter result you want (name or number)",vi:"Nhập kết quả mong muốn (tên hoặc số thứ tự)"}),":"]}),n.jsxs(u,{size:0,children:[E.map(((e,t)=>T===t?n.jsx(w,{ref:F,size:"small",style:y,value:M,onChange:J,onBlur:K,onPressEnter:K},e):n.jsx(m,{closable:!0,style:{userSelect:"none"},onClose:()=>(e=>{const n=E.filter((n=>n!==e));console.log(n),N(n)})(e),children:n.jsx("span",{onDoubleClick:n=>{0!==t&&(P(t),z(e),n.preventDefault())},children:e})},e))),H?n.jsx(w,{ref:B,type:"text",size:"small",style:y,value:q,onChange:U,onBlur:W,onPressEnter:W}):n.jsx(m,{style:j,icon:n.jsx("i",{className:"fa-solid fa-plus"}),onClick:O,children:x({en:"Add result",vi:"Thêm kết quả"})})]})]}),n.jsx(p,{}),n.jsx(t,{danger:!0,icon:n.jsx("i",{className:"fa-solid fa-close"}),iconPosition:"end",onClick:()=>{C.close(),I(null),o("HackDuckRace:closeDuckRace")},children:"Close duckrace"})]}):b?n.jsxs(u,{children:[n.jsx(c.Text,{children:x({en:"Openning Duckrace...",vi:"Đang mở Duckrace..."})}),n.jsx(d,{})]}):n.jsxs(n.Fragment,{children:[n.jsx(c.Text,{children:x({en:"Select game to start",vi:"Chọn trò bạn muốn chơi"})}),n.jsx(g,{align:"middle",justify:"center",children:k.map((e=>n.jsxs(u,{direction:"vertical",align:"center",style:{margin:8},children:[n.jsxs("div",{className:"show-on-hover-trigger",style:{position:"relative"},children:[n.jsx(f,{src:e.img,onClick:async()=>{var n;C&&(null==(n=null==C?void 0:C.close)||n.call(C)),S(!0);const t=window.open(e.url,"_blank");await r(t),_(e),I(t),S(!1),o("HackDuckRace:openDuckRace")},preview:!1,width:150,height:150,style:{borderRadius:10,cursor:"pointer"}},e.id),n.jsx("div",{className:"show-on-hover-item",style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",pointerEvents:"none"},children:n.jsx("i",{className:"fa-solid fa-arrow-up-right-from-square "})})]}),n.jsx(c.Text,{children:e.id})]},e.id)))})]})]})}const j={height:22,borderStyle:"dashed"},y={width:64,height:22,marginInlineEnd:8,verticalAlign:"top"};function v(e=[]){return`(() => {\n        let targets = ${JSON.stringify(e)};\n\n        let wins = Array.from(document.querySelectorAll("iframe")).map(\n          (_) => _?.contentWindow\n        );\n\n        [window, ...wins]\n          .filter((_) => _)\n          .forEach((win) => {\n            if (win.location.href.includes('html5/random-name-pickers') && win.Math.specialRandom) {\n              if(!win.fbaio_duckRace_specialRandom) win.fbaio_duckRace_specialRandom = win.Math.specialRandom;\n\n              win.Math.specialRandom = function () {\n                let result = win.fbaio_duckRace_specialRandom.apply(this, arguments);\n                if (win.holder_array?.length > 0) {\n                  for (let target of targets) {\n                    let found = win.holder_array.findIndex((i) => i == target);\n                    if (found >= 0) result = found;\n                  }\n                }\n                console.log("specialRandom", this, result);\n                return result;\n              };\n            } else {\n                if (!win.fbaio_duckRace_originalShuffle) {\n                    win.fbaio_duckRace_originalShuffle = win.Array.prototype.shuffle;\n                }\n                win.Array.prototype.shuffle = function () {\n                    const result = win.fbaio_duckRace_originalShuffle.apply(\n                    this,\n                    arguments\n                    );\n                    console.log(result, win);\n                    if (result?.[0]?.instance) {\n                    for (let target of targets) {\n                        let targetIndex = result.findIndex(\n                        (i) => i?.name === target || i?.number == target\n                        );\n                        if (targetIndex >= 0) {\n                        let temp = result[0];\n                        result[0] = result[targetIndex];\n                        result[targetIndex] = temp;\n                        break;\n                        }\n                    }\n                    }\n                    console.log("shuffle", this, result, result[0]);\n                    return result;\n                };\n            }\n          });\n      })();\n      `}export{x as default};
