const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./MyApp-D93h0aQZ.js","./index-BoH2j3cU.js","./index-DY-hiTTZ.css"])))=>i.map(i=>d[i]);
import{aQ as n,r as e,bl as i,b3 as t,c8 as a,b8 as o}from"./index-BoH2j3cU.js";import{aE as s,aF as c,aG as r,x as l,y as d,W as h,u as m,t as u,v as g,S as p,I as f,i as b,h as k,b as v,e as y,f as j,T as x,B as _,s as T,o as E}from"./MyApp-D93h0aQZ.js";import{a as S,G as B}from"./gender-D7cqwEK5.js";import w from"./MyTable-B-PXqHUM.js";import I from"./useCacheState-CRWoF5gI.js";import{E as D}from"./ExportButton-bON9fXxS.js";import{d as N}from"./dayjs.min-BtTaSKBf.js";import{u as C}from"./useAction-B53X_KY4.js";import{u as R}from"./useDevMode-BCrlvjeP.js";import{S as M}from"./Screen-BEv7M6xj.js";import{A}from"./index-BMF_2O9_.js";import{T as P}from"./index-IueWr_3q.js";import"./index-CLQrWQaN.js";import"./index-DFDl0PJq.js";import"./DownOutlined-DRGhK8zp.js";import"./Table-CSd7eQib.js";import"./List-BGWr2xJE.js";import"./index-BaNQURuW.js";import"./index-BS-7HFpi.js";import"./index-p3GZU5lJ.js";import"./index-DWB43XHw.js";import"./Dropdown-C4ZC00F-.js";import"./PurePanel-DNUOZ5MP.js";import"./move-DCq-oE7y.js";import"./index-CTitp5Qg.js";import"./index-UsPtaxTh.js";import"./SearchOutlined-BUONfEHJ.js";import"./useBreakpoint-CUrvcDr2.js";import"./Pagination-CIrtJa5e.js";import"./index-7X6rB-D6.js";import"./row-B1CxNhq6.js";import"./useVIP-f__zpoad.js";import"./sweetalert2.esm.all-BZxvatOx.js";import"./getIds-CXkkWBEB.js";import"./index-BwkmqrWl.js";import"./col-pZhDRk6E.js";import"./index-DD15UiBp.js";var F=(n=>(n.RESTRICTED_LIST="RESTRICTED_LIST",n.USER="USER",n.MESSAGE="MESSAGE",n.APP_INVITE="APP_INVITE",n.EVENT_INVITE="EVENT_INVITE",n))(F||{});const L={RESTRICTED_LIST:{icon:"fa-solid fa-ban",name:{en:"Restricted",vi:"Hạn chế"},desc:{en:"Restricted list:\nWhen you add someone's profile to your Restricted list, they won't see posts on Facebook that you share only to Friends\nThey may still see things you share to Public or on a mutual friend's profile, and posts their profile is tagged in\nFacebook doesn't notify your friends when you add them to your Restricted list.",vi:"Danh sách hạn chế:\nKhi bạn thêm trang cá nhân của ai đó vào Danh sách hạn chế thì trên Facebook, họ sẽ không nhìn thấy các bài viết mà bạn chỉ chia sẻ với Bạn bè\nHọ có thể vẫn nhìn thấy nội dung bạn chia sẻ Công khai hoặc trên trang cá nhân của một người bạn chung cũng như các bài viết có gắn thẻ trang cá nhân của họ\nFacebook không thông báo cho bạn bè của bạn khi bạn thêm họ vào Danh sách hạn chế."}},USER:{icon:"fa-solid fa-user",name:{en:"Profile/Page",vi:"Trang/Trang cá nhân"},desc:{en:"Block Profile/Page:\nOnce you block a profile or Page, you can no longer interact with each others' timelines, posts, comments or messages.\nThis doesn't include apps, games or groups you both participate in.\nIf you currently are connected with that profile or Page, blocking it will unfriend, unlike and unfollow it.",vi:"Chặn Trang/Trang cá nhân:\nSau khi bạn chặn một Trang/trang cá nhân, các bạn không thể tương tác với dòng thời gian, bài viết, bình luận hoặc tin nhắn của nhau nữa.\nĐiều này không áp dụng với ứng dụng, game hoặc nhóm mà cả 2 bạn cùng tham gia.\nNếu đang kết nối với Trang/trang cá nhân đó thì khi bạn chặn, hệ thống sẽ hủy kết bạn, bỏ thích và bỏ theo dõi Trang/trang cá nhân đó."}},MESSAGE:{icon:"fa-brands fa-facebook-messenger",name:{en:"Message",vi:"Tin nhắn"},desc:{en:"Block messages:\nIf you block someone's profile on Facebook, they won't be able to contact you in Messenger either\nUnless you block someone's Facebook profile and any others they may create, they may be able to post on your timeline, tag you, and comment on your posts or comments.",vi:"Chặn tin nhắn:\nNếu bạn chặn trang cá nhân của ai đó trên Facebook, họ cũng sẽ không thể liên hệ với bạn trong Messenger\nNếu bạn không chặn trang cá nhân Facebook của ai đó và bất kỳ trang cá nhân nào khác họ có khả năng tạo, họ sẽ có thể đăng bài lên dòng thời gian của bạn, gắn thẻ bạn và bình luận về bài viết hoặc bình luận của bạn."},confirm:{vi:"\nChặn tin nhắn và cuộc gọi\nThủy sẽ không bị chặn trên Facebook.\nBạn sẽ không nhận được tin nhắn hay cuộc gọi từ Thủy. Nếu bỏ chặn, bạn sẽ không nhận được bất kỳ nội dung nào mà người đó có thể đã gửi trong thời gian chặn.\nBạn và Thủy có thể nhìn thấy, nhắn tin và gọi cho nhau trong các nhóm chung, trừ khi bạn rời khỏi những nhóm đó."}},APP_INVITE:{icon:"fa-brands fa-google-play",name:{en:"App invite",vi:"Ứng dụng"},desc:{en:"Block app invites:\nOnce you block app invites from someone's profile, you'll automatically ignore future app requests from that person's profile.",vi:"Chặn lời mời cài đặt ứng dụng:\nSau khi chặn lời mời dùng ứng dụng từ trang cá nhân của người khác, bạn sẽ tự động bỏ qua các yêu cầu ứng dụng trong tương lai từ người đó."}},EVENT_INVITE:{icon:"fa-regular fa-calendar",name:{en:"Event invite",vi:"Sự kiện"},desc:{en:"Block event invites:\nOnce you block event invites from someone’s profile, you’ll automatically ignore future event requests from that profile.",vi:"Chặn lời mời tham gia sự kiện:\nKhi bạn chặn lời mời tham gia sự kiện từ trang cá nhân của một người, bạn sẽ tự động bỏ qua những lời mời trong tương lai từ trang cá nhân đó."}}};async function U({type:e,cursor:i}){const t=i?await d({fb_api_req_friendly_name:"BlockingSettingsBlockingListPaginationQuery",variables:{count:10,cursor:i,profile_picture_size:36,id:btoa("privacy_block_setting:"+e.toString().toLocaleLowerCase())},doc_id:"5186554984768632"}):await d({fb_api_req_friendly_name:"BlockingSettingsDialogQuery",variables:{profile_picture_size:36,settingType:e},doc_id:"5425356630905390"}),a=l(t);console.log(a);const{findDataObject:o}=await n((async()=>{const{findDataObject:n}=await import("./MyApp-D93h0aQZ.js").then((n=>n.a_));return{findDataObject:n}}),__vite__mapDeps([0,1,2]),import.meta.url),{edges:s=[],page_info:c}=o(a);return s.map((n=>{var i,t,a,o,s;return{type:e,id:null==(i=null==n?void 0:n.node)?void 0:i.id,name:null==(t=null==n?void 0:n.node)?void 0:t.name,avatar:null==(o=null==(a=null==n?void 0:n.node)?void 0:a.profile_picture)?void 0:o.uri,gender:(null==(s=null==n?void 0:n.node)?void 0:s.gender)||S.UNKNOWN,cursor:(null==n?void 0:n.cursor)||(null==c?void 0:c.end_cursor)}}))}let O=0;function Y(){const{devMode:Y}=R(),{ti:V}=m(),{onClickAction:q,onClickBulkActions:H}=C(),[G,z]=I("Blocked.type",F.RESTRICTED_LIST),[W,K]=I("Blocked.data",{}),[Q,Z]=I("Blocked.loading",{}),[J,$]=I("Blocking.noData",{}),[X,nn]=I("Blocked.blockTime",[]),en=e.useMemo((()=>i(W,(n=>{var e;for(const i in n)for(const t of n[i]){const n=null==(e=X.find((n=>n.id==t.id&&(n.isBlockMessage&&t.type==F.MESSAGE||!n.isBlockMessage&&[F.USER,F.RESTRICTED_LIST].includes(t.type)))))?void 0:e.time;n&&(t.time=n)}}))),[W,X]);e.useEffect((()=>{u("Blocked.onLoad"),async function(){var e;const i=await s(c.EAAB);if(!i)return[];const{fetchExtension:t}=await n((async()=>{const{fetchExtension:n}=await import("./index-BoH2j3cU.js").then((n=>n.cS));return{fetchExtension:n}}),__vite__mapDeps([1,2]),import.meta.url),a=await t("https://graph.facebook.com/v21.0/me/blocked?fields=name,username,fbid,block_type,block_time&limit=100&access_token="+i);r(a);const o=l(a);return(null==(e=null==o?void 0:o.data)?void 0:e.map((n=>({id:n.fbid,name:n.name,time:new Date(n.block_time),isBlockMessage:"messenger"==n.block_type}))))||[]}().then(nn)}),[]);const tn=(n,e,t="")=>{Z((a=>i(a,(i=>{i[n+t]=e}))))},an=(n,e)=>{K((t=>i(t,(i=>{i[n]=e}))))},on=(n,e)=>{$((t=>i(t,(i=>{i[n]=e}))))};e.useEffect((()=>{cn(G)}),[G]);const sn=e.useRef({}),cn=async(n,e=!1)=>{var i,t;if(!e&&(J[n]||sn.current[n]||(null==(i=en[n])?void 0:i.length)))return;e&&on(n,!1),sn.current[n]=!0,tn(n,!0);const a=[];let o="";for(;;)try{o=(null==(t=a[a.length-1])?void 0:t.cursor)||"";const e=await U({type:n,cursor:o});if(!(null==e?void 0:e.length)){a.length||on(n,!0);break}a.push(...e),console.log(a),an(n,[...a].map(((n,e)=>({...n,isBlocked:!0,index:e+1})))),await g(500)}catch(s){console.log(s)}sn.current[n]=!1,tn(n,!1)},rn=(e,t=!1)=>(tn(G,!0,e.id),q({record:e,id:e.id,key:"Blocked:onClickUnblock",actionFn:()=>Y?g(1e3):async function({id:e,type:i,value:t}){const a="UNBLOCK",o=await d({fb_api_req_friendly_name:"BlockingSettingsBlockMutation",variables:{input:{block_action:a,setting:i,target_id:e,actor_id:await h(),client_mutation_id:++O},profile_picture_size:36},doc_id:"6009824239038988"}),s=l(o),{deepFind:c}=await n((async()=>{const{deepFind:n}=await import("./MyApp-D93h0aQZ.js").then((n=>n.a_));return{deepFind:n}}),__vite__mapDeps([0,1,2]),import.meta.url);return c(s,"block_status")===a}({id:e.id,type:e.type,value:!1}),loadingText:()=>V({en:"Unblocking...",vi:"Đang bỏ chặn..."})+" "+e.name,successText:()=>V({en:"Unblocked",vi:"Đã bỏ chặn"})+" "+e.name,failedText:()=>V({en:"Failed to unblock",vi:"Lỗi bỏ chặn"})+" "+e.name,onSuccess:()=>{var n,t;n=G,t=e.id,K((e=>i(e,(e=>{const i=e[n].findIndex((n=>n.id===t));return i>=0&&e[n].splice(i,1),e}))))},needConfirm:t,confirmProps:{title:V({en:"Unblock ",vi:"Bỏ chặn "})+e.name+"?",text:V({en:"Warning: After 48 hours, you can block again this user.",vi:"Lưu ý: Sau 48h mới có thể chặn lại người này."})}}).finally((()=>{tn(G,!1,e.id)}))),ln=(n,e)=>T(n,(null==e?void 0:e.name)+(null==e?void 0:e.id)),dn=n=>e=>t.jsxs(p,{children:[t.jsx(o,{disabled:Q[n],type:"primary",icon:Q[n]?t.jsx("i",{className:"fa-solid fa-rotate-right fa-spin"}):t.jsx("i",{className:"fa-solid fa-rotate-right"}),onClick:()=>cn(n,!0),children:V({en:"Reload",vi:"Tải lại"})}),t.jsx(D,{data:(null==e?void 0:e.length)?e:en[n]||[],options:[{key:"uid",label:".txt (friend uid)",prepareData:n=>({fileName:"friends_"+N().format("YYYY-MM-DD-HHmmss")+".txt",data:n.map((n=>n.id)).join("\n")})},{key:"uid_name",label:".csv (uid+name)",prepareData:n=>({fileName:"blocked_uid_name_"+N().format("YYYY-MM-DD-HHmmss")+".csv",data:E(n.map((n=>({uid:n.id,name:n.name}))))})},{key:"json",label:".json",prepareData:n=>({fileName:"blocked"+N().format("YYYY-MM-DD-HHmmss")+".json",data:JSON.stringify(n,null,4)})},{key:"csv",label:".csv",prepareData:n=>({fileName:"blocked"+N().format("YYYY-MM-DD-HHmmss")+".csv",data:E(n)})}]}),(null==e?void 0:e.length)>0?t.jsx(o,{danger:!0,type:"default",icon:t.jsx("i",{className:"fa-regular fa-trash-can"}),onClick:()=>{return n=e,tn(G,!0),H({data:n,key:"Blocked:onClickUnblockBulk",actionFn:rn,loadingText:()=>V({en:"Unblocking...",vi:"Đang bỏ chặn..."}),successText:()=>V({en:"Unblocked",vi:"Đã bỏ chặn"}),successDescItem:n=>n.name,requireVIP:!1,confirmProps:{title:V({en:"Un-Block "+n.length+" users?",vi:"Bỏ chặn "+n.length+" người?"}),text:V({en:"Warning: After 48 hours, you can block again these users.",vi:"Lưu ý: Sau 48h mới có thể chặn lại những người này."})}}).finally((()=>{tn(G,!1)}));var n},children:V({en:"Unblock ",vi:"Bỏ chặn "})+e.length}):null,t.jsx(x,{title:V({en:"Coming soon",vi:"Sắp có"}),children:t.jsx(o,{disabled:!0,icon:t.jsx("i",{className:"fa-solid fa-plus"}),children:V({en:"Import",vi:"Chặn thêm"})})})]}),hn=[{title:"#",key:"index",dataIndex:"index",width:50},{title:V({en:"Name",vi:"Tên"}),key:"nane",dataIndex:"name",render:(n,e,i)=>t.jsxs(p,{style:{maxWidth:300},children:[t.jsx(A,{shape:"square",src:t.jsx(f,{src:e.avatar,fallback:b(e.id)}),size:50}),t.jsxs(p,{direction:"vertical",style:{marginLeft:"10px"},size:0,children:[t.jsx("a",{onClick:n=>{n.preventDefault();const i=k(e.id);e.isBlocked&&[F.USER].includes(e.type)?a(i):window.open(i,"_blank")},children:t.jsx("b",{children:e.name})}),t.jsx("span",{style:{opacity:.5},children:e.id})]})]}),width:"auto"},{title:V({en:"Gender",vi:"Giới tính"}),key:"gender",dataIndex:"gender",render:(n,e,i)=>{var a;return t.jsx(v,{color:(null==(a=B[e.gender])?void 0:a.color)||"default",children:V(B[e.gender])||e.gender})},filters:Object.values(S).map((n=>{var e,i;return{text:V(B[n])+" ("+(null==(i=null==(e=en[G])?void 0:e.filter((e=>e.gender===n)))?void 0:i.length)+")",value:n}})),onFilter:(n,e)=>e.gender===n,width:120},{title:V({en:"Time",vi:"Thời gian"}),key:"time",dataIndex:"time",render:(n,e,i)=>{const a=e.time;return a?t.jsxs(p,{direction:"vertical",size:0,children:[y(a.getTime()),t.jsx("span",{style:{opacity:.5},children:j(a)})]}):"-"},sorter:(n,e)=>n.time.getTime()-e.time.getTime(),width:170},{title:V({en:"Status",vi:"Trạng thái"}),key:"isBlocked",dataIndex:"isBlocked",render:(n,e,i)=>e.isBlocked?t.jsx(v,{color:"red",children:V({en:"Blocked",vi:"Đang chặn"})}):t.jsx(v,{color:"green",children:V({en:"Unblocked",vi:"Bỏ chặn"})}),width:120},{title:V({en:"Action",vi:"Hành động"}),render:(n,e,i)=>t.jsx(o,{loading:Q[G+e.id],icon:t.jsx("i",{className:"fa-solid fa-ban"}),onClick:()=>rn(e,!0),children:V({en:"Unblock",vi:"Bỏ chặn"})}),width:120}];return t.jsx(M,{title:V({en:"Blocked",vi:"Đang chặn"}),titleSuffix:t.jsx(o,{type:"default",icon:t.jsx("i",{className:"fa-solid fa-up-right-from-square"}),href:"https://www.facebook.com/settings/?tab=blocking",target:"_blank",style:{marginLeft:10}}),children:t.jsx(P,{defaultActiveKey:F.RESTRICTED_LIST,activeKey:G,onChange:n=>{u("Blocked:onChangeTab:"+n),z(n)},items:Object.values(F).map((n=>{var e;return{key:n,icon:Q[n]?t.jsx("i",{className:"fa fa-spinner fa-spin"}):t.jsx("i",{className:L[n].icon}),label:t.jsxs(x,{title:t.jsx(t.Fragment,{children:V(L[n].desc).split("\n").map(((e,i)=>t.jsx("p",{children:e},n+i)))}),children:[V(L[n].name)," ",t.jsx(_,{showZero:!0,count:J[n]?0:(null==(e=en[n])?void 0:e.length)||"",color:J[n]?"gray":"purple",style:{color:"white"}})]}),children:t.jsx(w,{columns:hn,data:en[n],keyExtractor:n=>null==n?void 0:n.id,searchable:!0,selectable:!0,size:"small",onSearchRow:ln,renderTitle:dn(n)})}}))})})}export{Y as default};
