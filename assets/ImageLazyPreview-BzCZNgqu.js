import{aW as e,r as a,b3 as o}from"./index-BoH2j3cU.js";import{getCacheByKey as r,setCacheByKey as t}from"./useCacheState-CRWoF5gI.js";import{u as n,I as s}from"./MyApp-D93h0aQZ.js";function i(i){const{cacheId:c,getPreview:l,renderPreview:f,...p}=i,{message:d}=e.useApp(),{ti:m}=n(),u=p.src||"",g="ImageLazyPreview."+(c||u),[y,v]=a.useState(!1),[w,j]=a.useState(r(g,"")),k=w||u;return o.jsx(s,{...p,preview:"function"==typeof f?f(k,y):{src:k},onClick:e=>{var a;null==(a=p.onClick)||a.call(p,e),(async()=>{if(!w)try{v(!0),d.loading({duration:0,key:g,content:m({en:"Loading...",vi:"Đang tải..."})});let e=performance.now();const a=await l();let o=performance.now();console.log("getPreview",o-e),a&&a!==u&&(j(a),t(g,a)),d.destroy(g)}catch(e){console.error(e),d.error({key:g,content:m({en:"Load failed: ",vi:"Load lỗi: "})+e.message})}finally{v(!1)}})()}})}export{i as default};
