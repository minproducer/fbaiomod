const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-BoH2j3cU.js","./index-DY-hiTTZ.css","./window-Dhlqh9T1.js","./MyApp-D93h0aQZ.js"])))=>i.map(i=>d[i]);
import{aQ as i}from"./index-BoH2j3cU.js";async function e(e){var n,t,o,l,a;const r=(null==(n=/https?:\/\/v.douyin.com\/([^/\s+]+)\//.exec(e))?void 0:n[0])||(null==(t=/https?:\/\/www.douyin.com\/video\/(\d+)/.exec(e))?void 0:t[0])||(null==(o=/https?:\/\/www.iesdouyin.com\/share\/video\/(\d+)/.exec(e))?void 0:o[0])||(null==(l=/https?:\/\/www.douyin.com\/user\/(.*)modal_id=(\d+)/.exec(e))?void 0:l[0])||(null==(a=/https?:\/\/www.douyin.com\/user\/(.*)vid=(\d+)/.exec(e))?void 0:a[0])||e,{getRedirectedUrl:d}=await i((async()=>{const{getRedirectedUrl:i}=await import("./index-BoH2j3cU.js").then((i=>i.cS));return{getRedirectedUrl:i}}),__vite__mapDeps([0,1]),import.meta.url);return await d(r,!0)}function n(i){var e,n,t;return(null==(e=/video\/(\d+)/.exec(i))?void 0:e[1])||(null==(n=/modal_id=(\d+)/.exec(i))?void 0:n[1])||(null==(t=/vid=(\d+)/.exec(i))?void 0:t[1])}function t(i){var e,n,t,o,l,a,r,d,u;if(!i)return null;const s=null==(e=null==i?void 0:i.video)?void 0:e.play_addr,c=[];for(let _ of["265","h264"]){const e=null==(n=null==i?void 0:i.video)?void 0:n["play_addr_"+_];e&&c.push({id:_,codecs:_,qualityLabel:_,height:e.height,width:e.width,mimeType:"video/mp4",isAudio:!1,source:null==(t=e.url_list)?void 0:t[0],urls:e.url_list,size:e.data_size})}const w=null==(o=null==i?void 0:i.video)?void 0:o.download_addr;w&&c.push({id:"watermark",codecs:"watermark",qualityLabel:"watermark",height:w.height,width:w.width,mimeType:"video/mp4",isAudio:!1,source:null==(l=w.url_list)?void 0:l[0],urls:w.url_list,size:w.data_size});const h=null==i?void 0:i.music;return h&&c.push({id:"music",codecs:"music",mimeType:"audio",isAudio:!0,source:null==(r=null==(a=h.play_url)?void 0:a.url_list)?void 0:r[0],urls:null==(d=h.play_url)?void 0:d.url_list,length:h.duration}),{id:null==i?void 0:i.aweme_id,source:null==(u=null==s?void 0:s.url_list)?void 0:u[0],width:null==s?void 0:s.width,height:null==s?void 0:s.height,url:null==i?void 0:i.share_url,quality:"default",variants:c}}async function o(e){const o=n(e);if(!o)throw new Error("Video ID not found");console.log(e,o);const{runFnInWin:a,waitWinForReady:r}=await i((async()=>{const{runFnInWin:i,waitWinForReady:e}=await import("./window-Dhlqh9T1.js");return{runFnInWin:i,waitWinForReady:e}}),__vite__mapDeps([2,3,0,1]),import.meta.url),d=window.open(e,"_blank","width=800,height=600");await r(d);const u=await async function(e){const{runFnInWin:n}=await i((async()=>{const{runFnInWin:i}=await import("./window-Dhlqh9T1.js");return{runFnInWin:i}}),__vite__mapDeps([2,3,0,1]),import.meta.url),t=await n({win:e,fnPath:"window.eval",params:['document.querySelector(`iframe[src*="captcha"]`) != null']});return!!t}(d);if(u)throw new Error("Douyin Captcha");const s=l({aweme_id:o}),c=await a({win:d,fnPath:"fetch",params:["https://www.douyin.com/aweme/v1/web/aweme/detail/?"+Object.entries(s).map((i=>i.join("="))).join("&")]});d.close(),console.log(c);const{parseSafe:w}=await i((async()=>{const{parseSafe:i}=await import("./MyApp-D93h0aQZ.js").then((i=>i.aX));return{parseSafe:i}}),__vite__mapDeps([3,0,1]),import.meta.url),h="string"==typeof c?w(c):null;return t(null==h?void 0:h.aweme_detail)}function l(i={}){return{device_platform:"webapp",aid:6383,channel:"channel_pc_web",support_h265:1,support_dash:1,cookie_enabled:!0,screen_width:screen.width,screen_height:screen.height,platform:"PC",downlink:10,effective_type:"4g",...i}}export{t as extractDouyinVideoInfo,e as extractRealDouyinUrl,n as extractVideoAwemeIdFromUrl,l as genParams,o as getDouyinVideoDetail};
