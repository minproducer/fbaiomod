const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./VideoWithMuted-B9CeRI4b.js","./index-BoH2j3cU.js","./index-DY-hiTTZ.css","./AudioWithMuted-Ch5roe_f.js","./MyApp-D93h0aQZ.js","./FileSaver.min-D9heDxZ4.js"])))=>i.map(i=>d[i]);
import{r as e,cP as i,b3 as t,b8 as a,aQ as s,b4 as n}from"./index-BoH2j3cU.js";import{getVideoInfo as o}from"./videos-CoQTeQLu.js";import{u as r,S as l,T as c,aV as d,ai as u,k as m}from"./MyApp-D93h0aQZ.js";const h=n((()=>s((()=>import("./VideoWithMuted-B9CeRI4b.js")),__vite__mapDeps([0,1,2]),import.meta.url)),{fallback:m}),f=n((()=>s((()=>import("./AudioWithMuted-Ch5roe_f.js")),__vite__mapDeps([3,1,2]),import.meta.url)),{fallback:m});function p({info:n,style:m,videoStyle:p,buttonTop:v=!1,getVideoInfoFn:j=o,defaultVariantTitle:x={en:"Default",vi:"Mặc định"},forceGetVideoInfo:y=!1}){var _;const{ti:g}=r(),[w,b]=e.useState(null),[A,k]=e.useState({}),[C,E]=e.useState(0),[T,V]=e.useState(!1),[I,R]=e.useState(n),S=(null==I?void 0:I.variants)||n.variants||[],O=(null==w?void 0:w.source)||(null==I?void 0:I.source);e.useEffect((()=>{(!n.source||y)&&n.id&&j?(V(!0),j(n.id).then((e=>{R(e)})).finally((()=>{V(!1)}))):R(n)}),[n.source,n.id,j]);const D=e.useRef(!1);e.useEffect((()=>{!(null==S?void 0:S.length)||Object.keys(A).length||D.current||(D.current=!0,Promise.all(S.map((e=>i(e.source).then((({url:i,size:t})=>{k((i=>({...i,[e.id]:t})))})).catch((()=>{console.log("ERROR get size",e)}))))).finally((()=>{D.current=!1})))}),[A,S]),e.useEffect((()=>{O&&i(O).then((({url:e,size:i})=>{E(i)}))}),[O]);const L=t.jsxs(l.Compact,{style:{maxWidth:600,flexWrap:"wrap",justifyContent:"center"},children:[t.jsx(c,{title:C?d(C,1):"",children:t.jsx(a,{type:w?"default":"primary",onClick:()=>b(null),children:g(x)})}),null==S?void 0:S.map(((e,i)=>t.jsx(c,{title:(e.isAudio?"":e.width+"x"+e.height)+(A[e.id]?" - "+d(A[e.id],1):""),children:t.jsxs(a,{type:(null==w?void 0:w.id)===e.id?"primary":"default",onClick:async()=>{b(e);const{trackEvent:i}=await s((async()=>{const{trackEvent:e}=await import("./MyApp-D93h0aQZ.js").then((e=>e.aY));return{trackEvent:e}}),__vite__mapDeps([4,1,2]),import.meta.url);i("VideoViewer:onChangeVariant:"+(e.qualityLabel||e.mimeType))},icon:e.isAudio?t.jsx("i",{className:"fa-solid fa-music"}):null,children:[e.qualityClass," ",e.qualityLabel||e.mimeType]})},e.id)))]});return t.jsxs(l,{direction:"vertical",style:{padding:15,borderRadius:10,backgroundColor:"#222",justifyContent:"center",alignItems:"center",overflowY:"auto",...m},children:[!T&&v&&L,T?t.jsx(u,{tip:g({en:"Loading video...",vi:"Đang tải video..."}),children:t.jsx("div",{style:{width:150,height:50}})}):null,(null==w?void 0:w.isAudio)?t.jsx(f,{src:O}):O?t.jsx(h,{src:O,style:{maxWidth:"90vw",maxHeight:"70vh",borderRadius:10,...p},children:null==(_=null==w?void 0:w.urls)?void 0:_.map(((e,i)=>t.jsx("source",{src:e},i)))}):null,O&&t.jsxs(l.Compact,{children:[t.jsx(c,{placement:"bottom",title:t.jsxs(t.Fragment,{children:[g({en:"If cannot download, try open FB_AIO in ",vi:"Nếu không tải được, hãy thử mở FB_AIO bằng "}),t.jsxs("a",{href:"https://coccoc.com/",target:"_blank",style:{color:"inherit",textDecoration:"underline"},children:[g({en:"Coc Coc Browser",vi:"Trình duyệt Cốc Cốc"})," ",t.jsx("i",{className:"fa-solid fa-arrow-up-right-from-square"})]})]}),children:t.jsx(a,{icon:t.jsx("i",{className:"fa-solid fa-download"}),onClick:async()=>{const{saveAs:e}=await s((async()=>{const{saveAs:e}=await import("./FileSaver.min-D9heDxZ4.js").then((e=>e.F));return{saveAs:e}}),__vite__mapDeps([5,1,2]),import.meta.url);e(O,(null==w?void 0:w.isAudio)?"audio.mp3":"video.mp4")},children:g({en:"Download",vi:"Tải xuống"})})}),t.jsx(a,{icon:t.jsx("i",{className:"fa-solid fa-arrow-up-right-from-square"}),onClick:()=>window.open(O,"_blank","noreferrer,noopener"),children:g({en:"New tab",vi:"Tab mới"})})]}),!T&&!v&&L]})}export{p as default};
