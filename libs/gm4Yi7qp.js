import{l as e}from"./Bx0Z_EIe.js";import{r as t,a as r}from"./BqUCZHEx.js";import"./BC9ybJZH.js";import"./Co2HKlK5.js";var n={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},u={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}};var l=function({children:e}){return r.createElement("div",{style:u.container},e)};var i=function({width:e,height:t,isEditorReady:u,loading:i,_ref:o,className:a,wrapperProps:c}){return r.createElement("section",{style:{...n.wrapper,width:e,height:t},...c},!u&&r.createElement(l,null,i),r.createElement("div",{ref:o,style:{...n.fullWidth,...!u&&n.hide},className:a}))},o=t.memo(i);var a=function(e){t.useEffect(e,[])};var c=function(e,r,n=!0){let u=t.useRef(!0);t.useEffect(u.current||!n?()=>{u.current=!1}:e,r)};function d(){}function s(e,t,r,n){return function(e,t){return e.editor.getModel(f(e,t))}(e,n)||function(e,t,r,n){return e.editor.createModel(t,r,n?f(e,n):void 0)}(e,t,r,n)}function f(e,t){return e.Uri.parse(t)}var g=function({original:n,modified:u,language:l,originalLanguage:i,modifiedLanguage:f,originalModelPath:g,modifiedModelPath:p,keepCurrentOriginalModel:v=!1,keepCurrentModifiedModel:h=!1,theme:M="light",loading:m="Loading...",options:E={},height:R="100%",width:w="100%",className:y,wrapperProps:x={},beforeMount:S=d,onMount:V=d}){let[L,C]=t.useState(!1),[k,O]=t.useState(!0),P=t.useRef(null),N=t.useRef(null),b=t.useRef(null),j=t.useRef(V),_=t.useRef(S),D=t.useRef(!1);a((()=>{let t=e.init();return t.then((e=>(N.current=e)&&O(!1))).catch((e=>"cancelation"!==(null==e?void 0:e.type)&&console.error("Monaco initialization: error:",e))),()=>P.current?function(){var e,t,r,n;let u=null==(e=P.current)?void 0:e.getModel();v||null==(t=null==u?void 0:u.original)||t.dispose(),h||null==(r=null==u?void 0:u.modified)||r.dispose(),null==(n=P.current)||n.dispose()}():t.cancel()})),c((()=>{if(P.current&&N.current){let e=P.current.getOriginalEditor(),t=s(N.current,n||"",i||l||"text",g||"");t!==e.getModel()&&e.setModel(t)}}),[g],L),c((()=>{if(P.current&&N.current){let e=P.current.getModifiedEditor(),t=s(N.current,u||"",f||l||"text",p||"");t!==e.getModel()&&e.setModel(t)}}),[p],L),c((()=>{let e=P.current.getModifiedEditor();e.getOption(N.current.editor.EditorOption.readOnly)?e.setValue(u||""):u!==e.getValue()&&(e.executeEdits("",[{range:e.getModel().getFullModelRange(),text:u||"",forceMoveMarkers:!0}]),e.pushUndoStop())}),[u],L),c((()=>{var e,t;null==(t=null==(e=P.current)?void 0:e.getModel())||t.original.setValue(n||"")}),[n],L),c((()=>{let{original:e,modified:t}=P.current.getModel();N.current.editor.setModelLanguage(e,i||l||"text"),N.current.editor.setModelLanguage(t,f||l||"text")}),[l,i,f],L),c((()=>{var e;null==(e=N.current)||e.editor.setTheme(M)}),[M],L),c((()=>{var e;null==(e=P.current)||e.updateOptions(E)}),[E],L);let T=t.useCallback((()=>{var e;if(!N.current)return;_.current(N.current);let t=s(N.current,n||"",i||l||"text",g||""),r=s(N.current,u||"",f||l||"text",p||"");null==(e=P.current)||e.setModel({original:t,modified:r})}),[l,u,f,n,i,g,p]),U=t.useCallback((()=>{var e;!D.current&&b.current&&(P.current=N.current.editor.createDiffEditor(b.current,{automaticLayout:!0,...E}),T(),null==(e=N.current)||e.editor.setTheme(M),C(!0),D.current=!0)}),[E,M,T]);return t.useEffect((()=>{L&&j.current(P.current,N.current)}),[L]),t.useEffect((()=>{!k&&!L&&U()}),[k,L,U]),r.createElement(o,{width:w,height:R,isEditorReady:L,loading:m,_ref:b,className:y,wrapperProps:x})},p=t.memo(g);var v=function(){let[r,n]=t.useState(e.__getMonacoInstance());return a((()=>{let t;return r||(t=e.init(),t.then((e=>{n(e)}))),()=>null==t?void 0:t.cancel()})),r};var h=function(e){let r=t.useRef();return t.useEffect((()=>{r.current=e}),[e]),r.current},M=new Map;var m=function({defaultValue:n,defaultLanguage:u,defaultPath:l,value:i,language:f,path:g,theme:p="light",line:v,loading:m="Loading...",options:E={},overrideServices:R={},saveViewState:w=!0,keepCurrentModel:y=!1,width:x="100%",height:S="100%",className:V,wrapperProps:L={},beforeMount:C=d,onMount:k=d,onChange:O,onValidate:P=d}){let[N,b]=t.useState(!1),[j,_]=t.useState(!0),D=t.useRef(null),T=t.useRef(null),U=t.useRef(null),z=t.useRef(k),F=t.useRef(C),I=t.useRef(),W=t.useRef(i),A=h(g),q=t.useRef(!1),B=t.useRef(!1);a((()=>{let t=e.init();return t.then((e=>(D.current=e)&&_(!1))).catch((e=>"cancelation"!==(null==e?void 0:e.type)&&console.error("Monaco initialization: error:",e))),()=>{return T.current?(null==(e=I.current)||e.dispose(),y?w&&M.set(g,T.current.saveViewState()):null==(r=T.current.getModel())||r.dispose(),void T.current.dispose()):t.cancel();var e,r}})),c((()=>{var e,t,r,o;let a=s(D.current,n||i||"",u||f||"",g||l||"");a!==(null==(e=T.current)?void 0:e.getModel())&&(w&&M.set(A,null==(t=T.current)?void 0:t.saveViewState()),null==(r=T.current)||r.setModel(a),w&&(null==(o=T.current)||o.restoreViewState(M.get(g))))}),[g],N),c((()=>{var e;null==(e=T.current)||e.updateOptions(E)}),[E],N),c((()=>{!T.current||void 0===i||(T.current.getOption(D.current.editor.EditorOption.readOnly)?T.current.setValue(i):i!==T.current.getValue()&&(B.current=!0,T.current.executeEdits("",[{range:T.current.getModel().getFullModelRange(),text:i,forceMoveMarkers:!0}]),T.current.pushUndoStop(),B.current=!1))}),[i],N),c((()=>{var e,t;let r=null==(e=T.current)?void 0:e.getModel();r&&f&&(null==(t=D.current)||t.editor.setModelLanguage(r,f))}),[f],N),c((()=>{var e;void 0!==v&&(null==(e=T.current)||e.revealLine(v))}),[v],N),c((()=>{var e;null==(e=D.current)||e.editor.setTheme(p)}),[p],N);let G=t.useCallback((()=>{var e;if(U.current&&D.current&&!q.current){F.current(D.current);let t=g||l,r=s(D.current,i||n||"",u||f||"",t||"");T.current=null==(e=D.current)?void 0:e.editor.create(U.current,{model:r,automaticLayout:!0,...E},R),w&&T.current.restoreViewState(M.get(t)),D.current.editor.setTheme(p),void 0!==v&&T.current.revealLine(v),b(!0),q.current=!0}}),[n,u,l,i,f,g,E,R,w,p,v]);return t.useEffect((()=>{N&&z.current(T.current,D.current)}),[N]),t.useEffect((()=>{!j&&!N&&G()}),[j,N,G]),W.current=i,t.useEffect((()=>{var e,t;N&&O&&(null==(e=I.current)||e.dispose(),I.current=null==(t=T.current)?void 0:t.onDidChangeModelContent((e=>{B.current||O(T.current.getValue(),e)})))}),[N,O]),t.useEffect((()=>{if(N){let e=D.current.editor.onDidChangeMarkers((e=>{var t;let r=null==(t=T.current.getModel())?void 0:t.uri;if(r&&e.find((e=>e.path===r.path))){let e=D.current.editor.getModelMarkers({resource:r});null==P||P(e)}}));return()=>{null==e||e.dispose()}}return()=>{}}),[N,P]),r.createElement(o,{width:x,height:S,isEditorReady:N,loading:m,_ref:U,className:V,wrapperProps:L})},E=t.memo(m),R=E;export{p as DiffEditor,E as Editor,R as default,e as loader,v as useMonaco};
