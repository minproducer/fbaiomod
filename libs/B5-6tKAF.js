var e,t,n,a,o,u,h,p,s,r;function l(){if(a)return n;a=1;var o=function(){if(t)return e;t=1;var n=function(e){this.value=e};return n.math={isDegree:!0,acos:function(e){return n.math.isDegree?180/Math.PI*Math.acos(e):Math.acos(e)},add:function(e,t){return e+t},asin:function(e){return n.math.isDegree?180/Math.PI*Math.asin(e):Math.asin(e)},atan:function(e){return n.math.isDegree?180/Math.PI*Math.atan(e):Math.atan(e)},acosh:function(e){return Math.log(e+Math.sqrt(e*e-1))},asinh:function(e){return Math.log(e+Math.sqrt(e*e+1))},atanh:function(e){return Math.log((1+e)/(1-e))},C:function(e,t){var a=1,o=e-t,u=t;u<o&&(u=o,o=t);for(var h=u+1;h<=e;h++)a*=h;return a/n.math.fact(o)},changeSign:function(e){return-e},cos:function(e){return n.math.isDegree&&(e=n.math.toRadian(e)),Math.cos(e)},cosh:function(e){return(Math.pow(Math.E,e)+Math.pow(Math.E,-1*e))/2},div:function(e,t){return e/t},fact:function(e){if(e%1!=0)return"NaN";for(var t=1,n=2;n<=e;n++)t*=n;return t},inverse:function(e){return 1/e},log:function(e){return Math.log(e)/Math.log(10)},mod:function(e,t){return e%t},mul:function(e,t){return e*t},P:function(e,t){for(var n=1,a=Math.floor(e)-Math.floor(t)+1;a<=Math.floor(e);a++)n*=a;return n},Pi:function(e,t,n){for(var a=1,o=e;o<=t;o++)a*=Number(n.postfixEval({n:o}));return a},pow10x:function(e){for(var t=1;e--;)t*=10;return t},sigma:function(e,t,n){for(var a=0,o=e;o<=t;o++)a+=Number(n.postfixEval({n:o}));return a},sin:function(e){return n.math.isDegree&&(e=n.math.toRadian(e)),Math.sin(e)},sinh:function(e){return(Math.pow(Math.E,e)-Math.pow(Math.E,-1*e))/2},sub:function(e,t){return e-t},tan:function(e){return n.math.isDegree&&(e=n.math.toRadian(e)),Math.tan(e)},tanh:function(e){return n.sinha(e)/n.cosha(e)},toRadian:function(e){return e*Math.PI/180},and:function(e,t){return e&t}},n.Exception=function(e){this.message=e},e=n}();function u(e,t){for(var n=0;n<e.length;n++)e[n]+=t;return e}for(var h=[{token:"sin",show:"sin",type:0,value:o.math.sin},{token:"cos",show:"cos",type:0,value:o.math.cos},{token:"tan",show:"tan",type:0,value:o.math.tan},{token:"pi",show:"&pi;",type:3,value:"PI"},{token:"(",show:"(",type:4,value:"("},{token:")",show:")",type:5,value:")"},{token:"P",show:"P",type:10,value:o.math.P},{token:"C",show:"C",type:10,value:o.math.C},{token:" ",show:" ",type:14,value:" ".anchor},{token:"asin",show:"asin",type:0,value:o.math.asin},{token:"acos",show:"acos",type:0,value:o.math.acos},{token:"atan",show:"atan",type:0,value:o.math.atan},{token:"7",show:"7",type:1,value:"7"},{token:"8",show:"8",type:1,value:"8"},{token:"9",show:"9",type:1,value:"9"},{token:"int",show:"Int",type:0,value:Math.floor},{token:"cosh",show:"cosh",type:0,value:o.math.cosh},{token:"acosh",show:"acosh",type:0,value:o.math.acosh},{token:"ln",show:" ln",type:0,value:Math.log},{token:"^",show:"^",type:10,value:Math.pow},{token:"root",show:"root",type:0,value:Math.sqrt},{token:"4",show:"4",type:1,value:"4"},{token:"5",show:"5",type:1,value:"5"},{token:"6",show:"6",type:1,value:"6"},{token:"/",show:"&divide;",type:2,value:o.math.div},{token:"!",show:"!",type:7,value:o.math.fact},{token:"tanh",show:"tanh",type:0,value:o.math.tanh},{token:"atanh",show:"atanh",type:0,value:o.math.atanh},{token:"Mod",show:" Mod ",type:2,value:o.math.mod},{token:"1",show:"1",type:1,value:"1"},{token:"2",show:"2",type:1,value:"2"},{token:"3",show:"3",type:1,value:"3"},{token:"*",show:"&times;",type:2,value:o.math.mul},{token:"sinh",show:"sinh",type:0,value:o.math.sinh},{token:"asinh",show:"asinh",type:0,value:o.math.asinh},{token:"e",show:"e",type:3,value:"E"},{token:"log",show:" log",type:0,value:o.math.log},{token:"0",show:"0",type:1,value:"0"},{token:".",show:".",type:6,value:"."},{token:"+",show:"+",type:9,value:o.math.add},{token:"-",show:"-",type:9,value:o.math.sub},{token:",",show:",",type:11,value:","},{token:"Sigma",show:"&Sigma;",type:12,value:o.math.sigma},{token:"n",show:"n",type:13,value:"n"},{token:"Pi",show:"&Pi;",type:12,value:o.math.Pi},{token:"pow",show:"pow",type:8,value:Math.pow,numberOfArguments:2},{token:"&",show:"&",type:9,value:o.math.and}],p={0:11,1:0,2:3,3:0,4:0,5:0,6:0,7:11,8:11,9:1,10:10,11:0,12:11,13:0,14:-1,15:11},s=0;s<h.length;s++)h[s].precedence=p[h[s].type];var r={0:!0,1:!0,3:!0,4:!0,6:!0,8:!0,9:!0,12:!0,13:!0,14:!0,15:!0},l={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0,10:!0,11:!0,12:!0,13:!0,15:!0},i={0:!0,3:!0,4:!0,8:!0,12:!0,13:!0,15:!0},v={},f={0:!0,1:!0,3:!0,4:!0,6:!0,8:!0,12:!0,13:!0,15:!0},y={1:!0},c=[[],["1","2","3","7","8","9","4","5","6","+","-","*","/","(",")","^","!","P","C","e","0",".",",","n"," ","&"],["pi","ln","Pi"],["sin","cos","tan","Del","int","Mod","log","pow"],["asin","acos","atan","cosh","root","tanh","sinh"],["acosh","atanh","asinh","Sigma"]];function w(e,t,n,a){for(var o=0;o<a;o++)if(e[n+o]!==t[o])return!1;return!0}function g(e,t){for(var n=0;n<t.length;n++)if(t[n].token===e)return n;return-1}o.tokenTypes={FUNCTION_WITH_ONE_ARG:0,NUMBER:1,BINARY_OPERATOR_HIGH_PRECENDENCE:2,CONSTANT:3,OPENING_PARENTHESIS:4,CLOSING_PARENTHESIS:5,DECIMAL:6,POSTFIX_FUNCTION_WITH_ONE_ARG:7,FUNCTION_WITH_N_ARGS:8,BINARY_OPERATOR_LOW_PRECENDENCE:9,BINARY_OPERATOR_PERMUTATION:10,COMMA:11,EVALUATED_FUNCTION:12,EVALUATED_FUNCTION_PARAMETER:13,SPACE:14},o.addToken=function(e){for(var t=0;t<e.length;t++){var n=e[t].token.length,a=-1;e[t].type===o.tokenTypes.FUNCTION_WITH_N_ARGS&&void 0===e[t].numberOfArguments&&(e[t].numberOfArguments=2),c[n]=c[n]||[];for(var u=0;u<c[n].length;u++)if(e[t].token===c[n][u]){a=g(c[n][u],h);break}-1===a?(h.push(e[t]),e[t].precedence=p[e[t].type],c.length<=e[t].token.length&&(c[e[t].token.length]=[]),c[e[t].token.length].push(e[t].token)):(h[a]=e[t],e[t].precedence=p[e[t].type])}};var m={value:o.math.changeSign,type:0,pre:21,show:"-"},k={value:")",show:")",type:5,pre:0},d={value:"(",type:4,pre:0,show:"("};return o.lex=function(e,t){var n,a=[d],p=[],s=e,E=r,M=0,N=v,P="";void 0!==t&&o.addToken(t);var x={},A=function(e){for(var t,n,a,u=[],p=e.length,s=0;s<p;s++)if(!(s<p-1&&" "===e[s]&&" "===e[s+1])){for(t="",n=e.length-s>c.length-2?c.length-1:e.length-s;n>0;n--)if(void 0!==c[n])for(a=0;a<c[n].length;a++)w(e,c[n][a],s,n)&&(t=c[n][a],a=c[n].length,n=0);if(s+=t.length-1,""===t)throw new o.Exception("Can't understand after "+e.slice(s));u.push(h[g(t,h)])}return u}(s);for(n=0;n<A.length;n++){var I=A[n];if(14!==I.type){var O,T=I.token,_=I.type,R=I.value,C=I.precedence,b=I.show,S=a[a.length-1];for(O=p.length;O--&&0===p[O];)if(-1!==[0,2,3,4,5,9,11,12,13].indexOf(_)){if(!0!==E[_])throw new o.Exception(T+" is not allowed after "+P);a.push(k),E=l,N=f,p.pop()}if(!0!==E[_])throw new o.Exception(T+" is not allowed after "+P);if(!0===N[_]&&(_=2,R=o.math.mul,b="&times;",C=3,n-=1),x={value:R,type:_,pre:C,show:b,numberOfArguments:I.numberOfArguments},0===_)E=r,N=v,u(p,2),a.push(x),4!==A[n+1].type&&(a.push(d),p.push(2));else if(1===_)1===S.type?(S.value+=R,u(p,1)):a.push(x),E=l,N=i;else if(2===_)E=r,N=v,u(p,2),a.push(x);else if(3===_)a.push(x),E=l,N=f;else if(4===_)u(p,1),M++,E=r,N=v,a.push(x);else if(5===_){if(!M)throw new o.Exception("Closing parenthesis are more than opening one, wait What!!!");M--,E=l,N=f,a.push(x),u(p,1)}else if(6===_){if(S.hasDec)throw new o.Exception("Two decimals are not allowed in one number");1!==S.type&&(S={value:0,type:1,pre:0},a.push(S)),E=y,u(p,1),N=v,S.value+=R,S.hasDec=!0}else 7===_&&(E=l,N=f,u(p,1),a.push(x));8===_?(E=r,N=v,u(p,I.numberOfArguments+2),a.push(x),4!==A[n+1].type&&(a.push(d),p.push(I.numberOfArguments+2))):9===_?(9===S.type?S.value===o.math.add?(S.value=R,S.show=b,u(p,1)):S.value===o.math.sub&&"-"===b&&(S.value=o.math.add,S.show="+",u(p,1)):5!==S.type&&7!==S.type&&1!==S.type&&3!==S.type&&13!==S.type?"-"===T&&(E=r,N=v,u(p,2).push(2),a.push(m),a.push(d)):(a.push(x),u(p,2)),E=r,N=v):10===_?(E=r,N=v,u(p,2),a.push(x)):11===_?(E=r,N=v,a.push(x)):12===_?(E=r,N=v,u(p,6),a.push(x),4!==A[n+1].type&&(a.push(d),p.push(6))):13===_&&(E=l,N=f,a.push(x)),u(p,-1),P=T}else if(n>0&&n<A.length-1&&1===A[n+1].type&&(1===A[n-1].type||6===A[n-1].type))throw new o.Exception("Unexpected Space")}for(O=p.length;O--;)a.push(k);if(!0!==E[5])throw new o.Exception("complete the expression");for(;M--;)a.push(k);return a.push(k),new o(a)},n=o}function i(){if(p)return h;p=1;var e=function(){if(u)return o;u=1;var e=l();return e.prototype.toPostfix=function(){for(var t,n,a,o,u,h=[],p=[{value:"(",type:4,pre:0}],s=this.value,r=1;r<s.length;r++)if(1===s[r].type||3===s[r].type||13===s[r].type)1===s[r].type&&(s[r].value=Number(s[r].value)),h.push(s[r]);else if(4===s[r].type)p.push(s[r]);else if(5===s[r].type)for(;4!==(n=p.pop()).type;)h.push(n);else if(11===s[r].type){for(;4!==(n=p.pop()).type;)h.push(n);p.push(n)}else{o=(t=s[r]).pre,a=(u=p[p.length-1]).pre;var l="Math.pow"==u.value&&"Math.pow"==t.value;if(o>a)p.push(t);else{for(;a>=o&&!l||l&&o<a;)n=p.pop(),u=p[p.length-1],h.push(n),a=u.pre,l="Math.pow"==t.value&&"Math.pow"==u.value;p.push(t)}}return new e(h)},o=e}();return e.prototype.postfixEval=function(t){(t=t||{}).PI=Math.PI,t.E=Math.E;for(var n,a,o,u=[],h=this.value,p=void 0!==t.n,s=0;s<h.length;s++)if(1===h[s].type)u.push({value:h[s].value,type:1});else if(3===h[s].type)u.push({value:t[h[s].value],type:1});else if(0===h[s].type)void 0===u[u.length-1].type?u[u.length-1].value.push(h[s]):u[u.length-1].value=h[s].value(u[u.length-1].value);else if(7===h[s].type)void 0===u[u.length-1].type?u[u.length-1].value.push(h[s]):u[u.length-1].value=h[s].value(u[u.length-1].value);else if(8===h[s].type){for(var r=[],l=0;l<h[s].numberOfArguments;l++)r.push(u.pop().value);u.push({type:1,value:h[s].value.apply(h[s],r.reverse())})}else 10===h[s].type?(n=u.pop(),void 0===(a=u.pop()).type?(a.value=a.concat(n),a.value.push(h[s]),u.push(a)):void 0===n.type?(n.unshift(a),n.push(h[s]),u.push(n)):u.push({type:1,value:h[s].value(a.value,n.value)})):2===h[s].type||9===h[s].type?(n=u.pop(),void 0===(a=u.pop()).type?((a=a.concat(n)).push(h[s]),u.push(a)):void 0===n.type?(n.unshift(a),n.push(h[s]),u.push(n)):u.push({type:1,value:h[s].value(a.value,n.value)})):12===h[s].type?(void 0!==(n=u.pop()).type&&(n=[n]),a=u.pop(),o=u.pop(),u.push({type:1,value:h[s].value(o.value,a.value,new e(n))})):13===h[s].type&&(p?u.push({value:t[h[s].value],type:3}):u.push([h[s]]));if(u.length>1)throw new e.Exception("Uncaught Syntax error");return u[0].value>1e15?"Infinity":parseFloat(u[0].value.toFixed(15))},e.eval=function(e,t,n){return void 0===t?this.lex(e).toPostfix().postfixEval():void 0===n?void 0!==t.length?this.lex(e,t).toPostfix().postfixEval():this.lex(e).toPostfix().postfixEval(t):this.lex(e,t).toPostfix().postfixEval(n)},h=e}function v(){if(r)return s;r=1;var e=i();return e.prototype.formulaEval=function(){for(var e,t,n,a=[],o=this.value,u=0;u<o.length;u++)1===o[u].type||3===o[u].type?a.push({value:3===o[u].type?o[u].show:o[u].value,type:1}):13===o[u].type?a.push({value:o[u].show,type:1}):0===o[u].type?a[a.length-1]={value:o[u].show+("-"!=o[u].show?"(":"")+a[a.length-1].value+("-"!=o[u].show?")":""),type:0}:7===o[u].type?a[a.length-1]={value:(1!=a[a.length-1].type?"(":"")+a[a.length-1].value+(1!=a[a.length-1].type?")":"")+o[u].show,type:7}:10===o[u].type?(e=a.pop(),t=a.pop(),"P"===o[u].show||"C"===o[u].show?a.push({value:"<sup>"+t.value+"</sup>"+o[u].show+"<sub>"+e.value+"</sub>",type:10}):a.push({value:(1!=t.type?"(":"")+t.value+(1!=t.type?")":"")+"<sup>"+e.value+"</sup>",type:1})):2===o[u].type||9===o[u].type?(e=a.pop(),t=a.pop(),a.push({value:(1!=t.type?"(":"")+t.value+(1!=t.type?")":"")+o[u].show+(1!=e.type?"(":"")+e.value+(1!=e.type?")":""),type:o[u].type})):12===o[u].type&&(e=a.pop(),t=a.pop(),n=a.pop(),a.push({value:o[u].show+"("+n.value+","+t.value+","+e.value+")",type:12}));return a[0].value},s=e}export{v as r};
